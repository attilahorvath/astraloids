!function t(e,r,n){function a(i,s){if(!r[i]){if(!e[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[i]={exports:{}};e[i][0].call(c.exports,function(t){var r=e[i][1][t];return a(r?r:t)},c,c.exports,t,e,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var a=t("./astraloids/game"),o=n(a),i=t("./astraloids/game_states/main_state"),s=n(i),l=new o["default"];l.run(new s["default"](l))},{"./astraloids/game":11,"./astraloids/game_states/main_state":13}],2:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix").mat4,i=t("gl-matrix").vec2,s=t("gl-matrix").vec4,l=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?i.create():arguments[0];n(this,t),this.position=e,this.calculateModelViewMatrix()}return a(t,[{key:"calculateModelViewMatrix",value:function(){this.translationVector=s.fromValues(this.position[0],this.position[1],0,1),this.modelViewMatrix=o.create(),o.translate(this.modelViewMatrix,this.modelViewMatrix,this.translationVector)}}]),t}();r["default"]=l},{"gl-matrix":30}],3:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=t("../entity"),u=n(l),c=t("../math"),f=t("gl-matrix").mat2,h=t("gl-matrix").mat4,d=t("gl-matrix").vec2,m=function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?d.create():arguments[1],n=arguments.length<=2||void 0===arguments[2]?d.create():arguments[2],i=arguments.length<=3||void 0===arguments[3]?d.create():arguments[3],s=arguments.length<=4||void 0===arguments[4]?0:arguments[4],l=arguments.length<=5||void 0===arguments[5]?0:arguments[5],u=arguments.length<=6||void 0===arguments[6]?0:arguments[6];a(this,e);var h=o(this,Object.getPrototypeOf(e).call(this,t,r,n,i,s,l,u));h.points=[];for(var m=0;m<2*Math.PI;m+=Math.PI/(3+6*Math.random())){var v=d.fromValues(0,-10-50*Math.random()),M=f.create();f.rotate(M,M,m),d.transformMat2(v,v,M),h.points.push(v)}h.triangleVertices=[],h.triangleIndices=(0,c.triangulate)(h.points);var p=!0,x=!1,b=void 0;try{for(var S,g=h.points[Symbol.iterator]();!(p=(S=g.next()).done);p=!0){var y=S.value;h.triangleVertices.push(y[0],y[1],0,1,1,1,1)}}catch(I){x=!0,b=I}finally{try{!p&&g["return"]&&g["return"]()}finally{if(x)throw b}}h.triangleVertexBuffer=t.renderer.createVertexBuffer(h.triangleVertices),h.triangleIndexBuffer=t.renderer.createIndexBuffer(h.triangleIndices),h.simpleShader=t.renderer.shaders.simpleShader,h.vertices=[];var w=(.2+.5*Math.random(),!0),D=!1,F=void 0;try{for(var _,E=h.points[Symbol.iterator]();!(w=(_=E.next()).done);w=!0){var P=_.value;h.vertices.push(P[0],P[1],0,0,1,.5,1)}}catch(I){D=!0,F=I}finally{try{!w&&E["return"]&&E["return"]()}finally{if(D)throw F}}return h.vertexBuffer=t.renderer.createVertexBuffer(h.vertices),h.pointShader=t.renderer.shaders.pointShader,h.angularVelocity=-5e-4+.001*Math.random(),h}return i(e,t),s(e,[{key:"draw",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?h.create():arguments[2];t.draw(this.simpleShader,r,this.triangleVertexBuffer,this.triangleIndexBuffer,t.gl.TRIANGLES,this.triangleIndices.length),this.pointShader.pointSizeValue=8,t.draw(this.pointShader,r,this.vertexBuffer,null,t.gl.POINTS,this.vertices.length/7),t.draw(this.pointShader,r,this.vertexBuffer,null,t.gl.LINE_LOOP,this.vertices.length/7)}},{key:"containsPoint",value:function(t){for(var e=arguments.length<=1||void 0===arguments[1]?h.create():arguments[1],r=0;r<this.triangleIndices.length;r+=3){var n=d.transformMat4(d.create(),this.points[this.triangleIndices[r]],e),a=d.transformMat4(d.create(),this.points[this.triangleIndices[r+1]],e),o=d.transformMat4(d.create(),this.points[this.triangleIndices[r+2]],e);if((0,c.pointInTriangle)(t,n,a,o))return!0}return!1}}]),e}(u["default"]);r["default"]=m},{"../entity":10,"../math":15,"gl-matrix":30}],4:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../entity"),l=n(s),u=t("./background_layer"),c=n(u),f=t("gl-matrix").vec2,h=function(t){function e(t,r){var n=arguments.length<=2||void 0===arguments[2]?f.create():arguments[2],i=arguments.length<=3||void 0===arguments[3]?f.create():arguments[3],s=arguments.length<=4||void 0===arguments[4]?f.create():arguments[4],l=arguments.length<=5||void 0===arguments[5]?0:arguments[5],u=arguments.length<=6||void 0===arguments[6]?0:arguments[6],h=arguments.length<=7||void 0===arguments[7]?0:arguments[7];a(this,e);var d=o(this,Object.getPrototypeOf(e).call(this,t,n,i,s,l,u,h));return d.ship=r,d.children.push(new c["default"](t,d,500,1,1,n,i,s,l,u,h)),d.children.push(new c["default"](t,d,500,1.5,2,n,i,s,l,u,h)),d.children.push(new c["default"](t,d,500,2,3,n,i,s,l,u,h)),d}return i(e,t),e}(l["default"]);r["default"]=h},{"../entity":10,"./background_layer":5,"gl-matrix":30}],5:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=t("../entity"),u=n(l),c=t("gl-matrix").mat4,f=t("gl-matrix").vec2,h=function(t){function e(t,r){var n=arguments.length<=2||void 0===arguments[2]?500:arguments[2],i=arguments.length<=3||void 0===arguments[3]?1:arguments[3],s=arguments.length<=4||void 0===arguments[4]?1:arguments[4],l=arguments.length<=5||void 0===arguments[5]?f.create():arguments[5],u=arguments.length<=6||void 0===arguments[6]?f.create():arguments[6],c=arguments.length<=7||void 0===arguments[7]?f.create():arguments[7],h=arguments.length<=8||void 0===arguments[8]?0:arguments[8],d=arguments.length<=9||void 0===arguments[9]?0:arguments[9],m=arguments.length<=10||void 0===arguments[10]?0:arguments[10];a(this,e);var v=o(this,Object.getPrototypeOf(e).call(this,t,l,u,c,h,d,m));v.background=r,v.stars=n,v.pointSize=i,v.relativeVelocity=s;for(var M=[],p=0;p<v.stars;p++)M.push(-t.renderer.dimensions[0]/2+Math.random()*t.renderer.dimensions[0],-t.renderer.dimensions[1]/2+Math.random()*t.renderer.dimensions[1],0,1,1,1,1);return v.vertexBuffer=t.renderer.createVertexBuffer(M),v.pointShader=t.renderer.shaders.pointShader,v}return i(e,t),s(e,[{key:"update",value:function(t,e){arguments.length<=2||void 0===arguments[2]?c.create():arguments[2];f.scaleAndAdd(this.position,this.position,this.background.ship.deltaPosition,1/this.relativeVelocity);for(var r=0;1>=r;r++)this.position[r]-t.renderer.dimensions[r]/2>this.background.ship.position[r]?this.position[r]-=t.renderer.dimensions[r]:this.position[r]+t.renderer.dimensions[r]/2<this.background.ship.position[r]&&(this.position[r]+=t.renderer.dimensions[r]);this.calculateTransformation()}},{key:"draw",value:function(t,e){arguments.length<=2||void 0===arguments[2]?c.create():arguments[2];this.pointShader.pointSizeValue=this.pointSize;for(var r=f.clone(this.position),n=0;4>n;n++)n%2===1&&(this.background.ship.position[0]<=this.position[0]?this.position[0]-=t.dimensions[0]:this.position[0]+=t.dimensions[0]),n>=2&&(this.background.ship.position[1]<=this.position[1]?this.position[1]-=t.dimensions[1]:this.position[1]+=t.dimensions[1]),this.calculateTransformation(),t.draw(this.pointShader,this.transformation,this.vertexBuffer,null,t.gl.POINTS,this.stars),this.position=f.clone(r);this.calculateTransformation()}}]),e}(u["default"]);r["default"]=h},{"../entity":10,"gl-matrix":30}],6:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=t("../entity"),u=n(l),c=(t("../math"),t("gl-matrix").mat4),f=t("gl-matrix").vec2,h=(t("gl-matrix").vec3,function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?f.create():arguments[1],n=arguments.length<=2||void 0===arguments[2]?f.create():arguments[2],i=arguments.length<=3||void 0===arguments[3]?f.create():arguments[3],s=arguments.length<=4||void 0===arguments[4]?0:arguments[4],l=arguments.length<=5||void 0===arguments[5]?0:arguments[5],u=arguments.length<=6||void 0===arguments[6]?0:arguments[6];a(this,e);var c=o(this,Object.getPrototypeOf(e).call(this,t,r,n,i,s,l,u));return c.vertices=[0,0,0,1,1,1,1,0,20,0,1,1,1,1,20,0,0,1,1,1,1],c.hoverVertices=[0,0,0,0,1,0,1,0,20,0,0,1,0,1,20,0,0,0,1,0,1],c.hover=!1,c.vertexBuffer=t.renderer.createVertexBuffer(c.vertices),c.simpleShader=t.renderer.shaders.simpleShader,c}return i(e,t),s(e,[{key:"update",value:function(t,e){var r=this;arguments.length<=2||void 0===arguments[2]?c.create():arguments[2];f.subtract(this.position,t.mouseInput.position,t.renderer.camera.position),this.integrateValues(e),this.calculateTransformation(),this.hover=t.gameState.ship.containsPointInAll(this.position)||t.gameState.asteroids.some(function(t){return t.containsPointInAll(r.position)}),this.hover?t.renderer.fillVertexBuffer(this.vertexBuffer,this.hoverVertices):t.renderer.fillVertexBuffer(this.vertexBuffer,this.vertices)}},{key:"draw",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?c.create():arguments[2];t.draw(this.simpleShader,r,this.vertexBuffer,null,t.gl.TRIANGLES,3)}}]),e}(u["default"]));r["default"]=h},{"../entity":10,"../math":15,"gl-matrix":30}],7:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=t("../entity"),u=n(l),c=t("../particle"),f=n(c),h=t("gl-matrix").mat4,d=t("gl-matrix").vec2,m=t("gl-matrix").vec3,v=(t("gl-matrix").vec4,1e3),M=function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?100:arguments[1],n=arguments.length<=2||void 0===arguments[2]?1.5:arguments[2],i=arguments.length<=3||void 0===arguments[3]?d.create():arguments[3],s=arguments.length<=4||void 0===arguments[4]?d.create():arguments[4],l=arguments.length<=5||void 0===arguments[5]?d.create():arguments[5],u=arguments.length<=6||void 0===arguments[6]?0:arguments[6],c=arguments.length<=7||void 0===arguments[7]?0:arguments[7],f=arguments.length<=8||void 0===arguments[8]?0:arguments[8];a(this,e);var h=o(this,Object.getPrototypeOf(e).call(this,t,i,s,l,u,c,f));return h.particleShader=t.renderer.shaders.particleShader,h.currentTime=0,h.lifetime=r,h.pointSize=n,h.vertices=new Float32Array(v*(h.particleShader.vertexSize/Float32Array.BYTES_PER_ELEMENT)),h.vertexCount=0,h.vertexIndex=0,h.vertexBuffer=t.renderer.createVertexBuffer(h.vertices),h}return i(e,t),s(e,[{key:"emitParticle",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?h.create():arguments[2],n=arguments.length<=3||void 0===arguments[3]?m.fromValues(Math.random(),Math.random(),Math.random()):arguments[3];this.emitParticles(t,[new f["default"](e,n)],r)}},{key:"emitParticles",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?h.create():arguments[2];r=h.clone(r),h.multiply(r,r,this.transformation),this.vertexCount+=e.length,this.vertexCount>v&&(this.vertexCount=v);var n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value,u=d.create();d.transformMat4(u,u,r),this.vertexIndex=++this.vertexIndex%v;var c=this.vertexIndex*(this.particleShader.vertexSize/Float32Array.BYTES_PER_ELEMENT);this.vertices[c++]=u[0],this.vertices[c++]=u[1],this.vertices[c++]=0,this.vertices[c++]=l.velocity[0],this.vertices[c++]=l.velocity[1],this.vertices[c++]=0,this.vertices[c++]=l.color[0],this.vertices[c++]=l.color[1],this.vertices[c++]=l.color[2],this.vertices[c++]=1,this.vertices[c++]=this.currentTime}}catch(f){a=!0,o=f}finally{try{!n&&s["return"]&&s["return"]()}finally{if(a)throw o}}t.fillVertexBuffer(this.vertexBuffer,this.vertices)}},{key:"update",value:function(t,e){arguments.length<=2||void 0===arguments[2]?h.create():arguments[2];this.currentTime+=e,this.integrateValues(e),this.calculateTransformation()}},{key:"draw",value:function(t,e){arguments.length<=2||void 0===arguments[2]?h.create():arguments[2];this.vertexCount>0&&(this.particleShader.currentTimeValue=this.currentTime,this.particleShader.lifetimeValue=this.lifetime,this.particleShader.pointSizeValue=this.pointSize,t.draw(this.particleShader,h.create(),this.vertexBuffer,null,t.gl.POINTS,this.vertexCount))}}]),e}(u["default"]);r["default"]=M},{"../entity":10,"../particle":18,"gl-matrix":30}],8:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=t("../entity"),u=n(l),c=t("gl-matrix").mat4,f=t("gl-matrix").vec2,h=function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?f.create():arguments[1],n=arguments.length<=2||void 0===arguments[2]?f.create():arguments[2],i=arguments.length<=3||void 0===arguments[3]?f.create():arguments[3],s=arguments.length<=4||void 0===arguments[4]?0:arguments[4],l=arguments.length<=5||void 0===arguments[5]?0:arguments[5],u=arguments.length<=6||void 0===arguments[6]?0:arguments[6];a(this,e);var c=o(this,Object.getPrototypeOf(e).call(this,t,r,n,i,s,l,u)),h=[0,0,0,.3,1,1,1,0,25,0,.3,1,1,1],d=[0,0,0,1,0,0,1,0,25,0,1,0,0,1];return c.vertexBuffer=t.renderer.createVertexBuffer(h),c.hitVertexBuffer=t.renderer.createVertexBuffer(d),c.simpleShader=t.renderer.shaders.simpleShader,c.active=!0,c}return i(e,t),s(e,[{key:"update",value:function(t,e){var r=this;arguments.length<=2||void 0===arguments[2]?c.create():arguments[2];this.integrateValues(e),this.calculateTransformation(),this.hit=t.gameState.asteroids.some(function(t){return t.containsPointInAll(r.position)})}},{key:"draw",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?c.create():arguments[2];t.setLineWidth(3),this.hit?t.draw(this.simpleShader,r,this.hitVertexBuffer,null,t.gl.LINES,2):t.draw(this.simpleShader,r,this.vertexBuffer,null,t.gl.LINES,2)}}]),e}(u["default"]);r["default"]=h},{"../entity":10,"gl-matrix":30}],9:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=t("../entity"),u=n(l),c=t("../particle"),f=n(c),h=t("./particle_emitter"),d=n(h),m=t("./projectile"),v=n(m),M=t("../math"),p=t("gl-matrix").mat2,x=t("gl-matrix").mat4,b=t("gl-matrix").vec2,S=t("gl-matrix").vec3,g=function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?b.create():arguments[1],n=arguments.length<=2||void 0===arguments[2]?b.create():arguments[2],i=arguments.length<=3||void 0===arguments[3]?b.create():arguments[3],s=arguments.length<=4||void 0===arguments[4]?0:arguments[4],l=arguments.length<=5||void 0===arguments[5]?0:arguments[5],u=arguments.length<=6||void 0===arguments[6]?0:arguments[6];a(this,e);var c=o(this,Object.getPrototypeOf(e).call(this,t,r,n,i,s,l,u));c.points=[b.fromValues(0,-30),b.fromValues(-25,30),b.fromValues(25,30)],c.vertices=[];var f=!0,h=!1,m=void 0;try{for(var v,M=c.points[Symbol.iterator]();!(f=(v=M.next()).done);f=!0){var p=v.value;c.vertices.push(p[0],p[1],0,1,0,0,1)}}catch(x){h=!0,m=x}finally{try{!f&&M["return"]&&M["return"]()}finally{if(h)throw m}}return c.vertexBuffer=t.renderer.createVertexBuffer(c.vertices),c.simpleShader=t.renderer.shaders.simpleShader,c.thruster=new d["default"](t,500,5,b.fromValues(0,30)),c.frontLeftSteerer=new d["default"](t,100,3,b.fromValues(-5,-20)),c.frontRightSteerer=new d["default"](t,100,3,b.fromValues(5,-20)),c.backLeftSteerer=new d["default"](t,100,3,b.fromValues(-20,20)),c.backRightSteerer=new d["default"](t,100,3,b.fromValues(20,20)),c.children.push(c.thruster),c.children.push(c.frontLeftSteerer),c.children.push(c.frontRightSteerer),c.children.push(c.backLeftSteerer),c.children.push(c.backRightSteerer),c.laserTimer=0,c}return i(e,t),s(e,[{key:"update",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?x.create():arguments[2];this.angularVelocity=0;var n=0,a=!1,o=!1,i=!1,s=!1;if((t.keyboardInput.keysDown[87]||t.keyboardInput.keysDown[38])&&(n+=.001,a=!0),(t.keyboardInput.keysDown[83]||t.keyboardInput.keysDown[40])&&(n-=2e-4,o=!0),(t.keyboardInput.keysDown[65]||t.keyboardInput.keysDown[37])&&(this.angularVelocity-=.002,i=!0),(t.keyboardInput.keysDown[68]||t.keyboardInput.keysDown[39])&&(this.angularVelocity+=.002,s=!0),t.keyboardInput.keysDown[32]||t.keyboardInput.keysDown[70]){if(this.laserTimer-=e,this.laserTimer<=0){var l=b.fromValues(0,-45),u=b.fromValues(0,-.5),c=p.create();p.rotate(c,c,this.angle),b.transformMat2(l,l,c),b.transformMat2(u,u,c),b.add(l,l,this.position),t.gameState.entities.push(new v["default"](t,l,u,b.create(),this.angle)),this.laserTimer=200}}else this.laserTimer=0;var f=p.create();p.rotate(f,f,this.angle),b.set(this.acceleration,0,-n),b.transformMat2(this.acceleration,this.acceleration,f),this.integrateValues(e),this.calculateTransformation(),b.length(this.velocity)>.2&&(b.normalize(this.velocity,this.velocity),b.scale(this.velocity,this.velocity,.2)),a&&this.thruster.emitParticle(t.renderer,b.create(),r,S.fromValues(.5+.5*Math.random(),0,0)),o&&(this.emitSteeringParticles(this.frontLeftSteerer,t.renderer,10,0,-1,r),this.emitSteeringParticles(this.frontRightSteerer,t.renderer,10,0,-1,r)),i&&(this.emitSteeringParticles(this.frontRightSteerer,t.renderer,10,1,0,r),this.emitSteeringParticles(this.backLeftSteerer,t.renderer,10,-1,0,r)),s&&(this.emitSteeringParticles(this.frontLeftSteerer,t.renderer,10,-1,0,r),this.emitSteeringParticles(this.backRightSteerer,t.renderer,10,1,0,r))}},{key:"draw",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?x.create():arguments[2];t.draw(this.simpleShader,r,this.vertexBuffer,null,t.gl.TRIANGLES,3)}},{key:"containsPoint",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?x.create():arguments[1],r=b.transformMat4(b.create(),this.points[0],e),n=b.transformMat4(b.create(),this.points[1],e),a=b.transformMat4(b.create(),this.points[2],e);return(0,M.pointInTriangle)(t,r,n,a)}},{key:"emitSteeringParticles",value:function(t,e,r,n,a,o){for(var i=[],s=0;r>s;s++){var l=0===n?-.05+.1*Math.random():(.2+.2*Math.random())*n,u=0===a?-.05+.1*Math.random():(.2+.2*Math.random())*a,c=b.fromValues(l,u),h=p.create();p.rotate(h,h,this.angle),b.transformMat2(c,c,h),b.add(c,c,this.velocity),i.push(new f["default"](c,S.fromValues(.5+.5*Math.random(),.5+.5*Math.random(),.5+.5*Math.random())))}t.emitParticles(e,i,o)}}]),e}(u["default"]);r["default"]=g},{"../entity":10,"../math":15,"../particle":18,"./particle_emitter":7,"./projectile":8,"gl-matrix":30}],10:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix").mat4,i=t("gl-matrix").vec2,s=t("gl-matrix").vec3,l=(t("gl-matrix").vec4,function(){function t(e){var r=arguments.length<=1||void 0===arguments[1]?i.create():arguments[1],a=arguments.length<=2||void 0===arguments[2]?i.create():arguments[2],o=arguments.length<=3||void 0===arguments[3]?i.create():arguments[3],s=arguments.length<=4||void 0===arguments[4]?0:arguments[4],l=arguments.length<=5||void 0===arguments[5]?0:arguments[5],u=arguments.length<=6||void 0===arguments[6]?0:arguments[6];n(this,t),this.position=i.clone(r),this.velocity=i.clone(a),this.acceleration=i.clone(o),this.deltaPosition=i.create(),this.deltaVelocity=i.create(),this.angle=s,this.angularVelocity=l,this.angularAcceleration=u,this.deltaAngle=0,this.deltaAngularVelocity=0,this.calculateTransformation(),this.children=[]}return a(t,[{key:"updateAll",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?o.create():arguments[2];r=o.clone(r),o.multiply(r,r,this.transformation);var n=!0,a=!1,i=void 0;try{for(var s,l=this.children[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;u.updateAll(t,e,r)}}catch(c){a=!0,i=c}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw i}}this.update(t,e,r)}},{key:"update",value:function(t,e){arguments.length<=2||void 0===arguments[2]?o.create():arguments[2];this.integrateValues(e),this.calculateTransformation()}},{key:"drawAll",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?o.create():arguments[2];r=o.clone(r),o.multiply(r,r,this.transformation);var n=!0,a=!1,i=void 0;try{for(var s,l=this.children[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;u.drawAll(t,e,r)}}catch(c){a=!0,i=c}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw i}}this.draw(t,e,r)}},{key:"draw",value:function(t,e){arguments.length<=2||void 0===arguments[2]?o.create():arguments[2]}},{key:"integrateValues",value:function(t){var e=i.clone(this.position),r=i.clone(this.velocity);i.scaleAndAdd(this.velocity,this.velocity,this.acceleration,t),i.scaleAndAdd(this.position,this.position,this.velocity,t),i.subtract(this.deltaPosition,this.position,e),i.subtract(this.deltaVelocity,this.velocity,r);var n=this.angle,a=this.angularVelocity;this.angularVelocity+=this.angularAcceleration*t,this.angle+=this.angularVelocity*t,this.deltaAngle=this.angle-n,this.deltaAngularVelocity=this.angularVelocity-a}},{key:"calculateTransformation",value:function(){var t=s.fromValues(this.position[0],this.position[1],0);this.transformation=o.create(),o.translate(this.transformation,this.transformation,t),o.rotateZ(this.transformation,this.transformation,this.angle)}},{key:"containsPointInAll",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?o.create():arguments[1];return e=o.clone(e),o.multiply(e,e,this.transformation),this.children.some(function(r){return r.containsPoint(t,e)})||this.containsPoint(t,e)}},{key:"containsPoint",value:function(t){arguments.length<=1||void 0===arguments[1]?o.create():arguments[1];return!1}}]),t}());r["default"]=l},{"gl-matrix":30}],11:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("./renderer"),s=n(i),l=t("./keyboard_input"),u=n(l),c=t("./mouse_input"),f=n(c),h=function(){function t(){a(this,t),this.renderer=new s["default"],this.keyboardInput=new u["default"],this.mouseInput=new f["default"](this.renderer)}return o(t,[{key:"run",value:function(t){var e=this;this.gameState=t,this.lastTime=Date.now(),requestAnimationFrame(function(){return e.loop()})}},{key:"loop",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?Date.now():arguments[0];requestAnimationFrame(function(){return t.loop()});var r=e-this.lastTime;this.keyboardInput.update(),this.mouseInput.update(),this.gameState.update(r),this.gameState.draw(r),this.gameState=this.gameState.nextState,this.lastTime=e}}]),t}();r["default"]=h},{"./keyboard_input":14,"./mouse_input":17,"./renderer":20}],12:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e){n(this,t),this.game=e,this.renderer=this.game.renderer,this.entities=[],this.nextState=this}return a(t,[{key:"update",value:function(t){var e=!0,r=!1,n=void 0;try{for(var a,o=this.entities[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;i.updateAll(this.game,t)}}catch(s){r=!0,n=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}}},{key:"draw",value:function(t){var e=!0,r=!1,n=void 0;try{for(var a,o=this.entities[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;i.drawAll(this.renderer,t)}}catch(s){r=!0,n=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}}}]),t}();r["default"]=o},{}],13:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=function g(t,e,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:g(a,e,r)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(r)},u=t("../game_state"),c=n(u),f=t("../entities/background"),h=n(f),d=t("../entities/ship"),m=n(d),v=t("../entities/asteroid"),M=n(v),p=t("../entities/cursor"),x=n(p),b=t("gl-matrix").vec2,S=function(t){function e(t){a(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t));r.ship=new m["default"](r.game),r.entities.push(new h["default"](r.game,r.ship)),r.asteroids=[];for(var n=0;10>n;n++){var i=new M["default"](r.game,b.fromValues(-r.renderer.dimensions[0]/2+Math.random()*r.renderer.dimensions[0],-r.renderer.dimensions[1]/2+Math.random()*r.renderer.dimensions[1]));r.asteroids.push(i),r.entities.push(i)}return r.entities.push(r.ship),
r.entities.push(new x["default"](r.game)),r}return i(e,t),s(e,[{key:"update",value:function(t){l(Object.getPrototypeOf(e.prototype),"update",this).call(this,t);var r=b.negate(b.create(),this.ship.position);b.scaleAndAdd(r,r,this.renderer.dimensions,.5),this.renderer.camera.position=r,this.renderer.camera.calculateModelViewMatrix()}},{key:"draw",value:function(t){this.renderer.postProcessor.begin(!0),l(Object.getPrototypeOf(e.prototype),"draw",this).call(this,t),this.renderer.postProcessor.end(),this.renderer.clear(),l(Object.getPrototypeOf(e.prototype),"draw",this).call(this,t),this.renderer.postProcessor.process(this.renderer.shaders.thresholdShader),this.renderer.shaders.blurShader.textureSizeValue=b.clone(this.renderer.postProcessor.downscaledDimensions),this.renderer.shaders.blurShader.directionValue=[1,0],this.renderer.postProcessor.process(this.renderer.shaders.blurShader),this.renderer.shaders.blurShader.directionValue=[0,1],this.renderer.postProcessor.process(this.renderer.shaders.blurShader),this.renderer.postProcessor.draw(this.renderer.shaders.textureShader,!0)}}]),e}(c["default"]);r["default"]=S},{"../entities/asteroid":3,"../entities/background":4,"../entities/cursor":6,"../entities/ship":9,"../game_state":12,"gl-matrix":30}],14:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(){var e=this;n(this,t),this.recordedKeysDown={},this.keysDown={},this.justPressed={},this.justReleased={},addEventListener("keydown",function(t){e.recordedKeysDown[t.keyCode]=!0}),addEventListener("keyup",function(t){delete e.recordedKeysDown[t.keyCode]})}return a(t,[{key:"update",value:function(){var t=Object.assign({},this.keysDown);this.keysDown=Object.assign({},this.recordedKeysDown),this.justPressed={};var e=!0,r=!1,n=void 0;try{for(var a,o=Object.keys(this.keysDown)[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;t[i]||(this.justPressed[i]=!0)}}catch(s){r=!0,n=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}this.justReleased={};var l=!0,u=!1,c=void 0;try{for(var f,h=Object.keys(t)[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var d=f.value;this.keysDown[d]||(this.justReleased[d]=!0)}}catch(s){u=!0,c=s}finally{try{!l&&h["return"]&&h["return"]()}finally{if(u)throw c}}}}]),t}();r["default"]=o},{}],15:[function(t,e,r){"use strict";function n(t,e,r,n){var a=i.subtract(i.create(),n,e),o=i.subtract(i.create(),r,e),s=i.subtract(i.create(),t,e),l=i.dot(a,a),u=i.dot(a,o),c=i.dot(a,s),f=i.dot(o,o),h=i.dot(o,s),d=1/(l*f-u*u),m=(f*c-u*h)*d,v=(l*h-u*c)*d;return m>=0&&v>=0&&1>m+v}function a(t){if(t.length<=3)return[0,1,2];for(var e=0;e<t.length;e++){var r=(t.length+e-1)%t.length,a=(e+1)%t.length,o=t[r],l=t[e],u=t[a],c=i.subtract(i.create(),l,o),f=i.subtract(i.create(),u,o),h=i.cross(s.create(),c,f);if(h[2]>0){for(var d=!0,m=0;m<t.length;m++)if(m!==r&&m!==e&&m!==a&&n(t[m],o,l,u)){d=!1;break}if(d)return[r,e,a]}}return null}function o(t){for(var e=t.slice(),r=[];e.length>2;){var n=a(e);if(!n)return null;r.push(e[n[0]],e[n[1]],e[n[2]]),e.splice(n[1],1)}return r.map(function(e){return t.indexOf(e)})}Object.defineProperty(r,"__esModule",{value:!0});var i=t("gl-matrix").vec2,s=t("gl-matrix").vec3;r.pointInTriangle=n,r.findEar=a,r.triangulate=o},{"gl-matrix":30}],16:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=t("./vertex_attribute"),u=n(l),c=function(t){function e(t){var r=arguments.length<=1||void 0===arguments[1]?4:arguments[1];a(this,e);var n=o(this,Object.getPrototypeOf(e).call(this,t,r*r));return n.size=r,n.uniformMethod="uniformMatrix"+n.size+"fv",n}return i(e,t),s(e,[{key:"setUniformValue",value:function(t,e,r){t[this.uniformMethod](e,!1,r)}}]),e}(u["default"]);r["default"]=c},{"./vertex_attribute":29}],17:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix").vec2,i=function(){function t(e){var r=this;n(this,t),this.canvas=e.canvas,this.recordedPosition=o.create(),this.position=o.create(),this.deltaPosition=o.create(),this.recorderButtonsDown={},this.buttonsDown={},this.justPressed={},this.justReleased={},addEventListener("mousemove",function(t){var e=r.canvas.getBoundingClientRect();r.recordedPosition=o.fromValues(t.clientX-e.left,t.clientY-e.top)}),addEventListener("mousedown",function(t){switch(t.button){case 0:r.recorderButtonsDown.left=!0;break;case 1:r.recorderButtonsDown.middle=!0;break;case 2:r.recorderButtonsDown.right=!0}}),addEventListener("mouseup",function(t){switch(t.button){case 0:delete r.recorderButtonsDown.left;break;case 1:delete r.recorderButtonsDown.middle;break;case 2:delete r.recorderButtonsDown.right}})}return a(t,[{key:"update",value:function(){var t=o.clone(this.position);this.position=o.clone(this.recordedPosition),o.subtract(this.deltaPosition,this.position,t);var e=Object.assign({},this.buttonsDown);this.buttonsDown=Object.assign({},this.recorderButtonsDown),this.justPressed={};var r=!0,n=!1,a=void 0;try{for(var i,s=Object.keys(this.buttonsDown)[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value;e[l]||(this.justPressed[l]=!0)}}catch(u){n=!0,a=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(n)throw a}}this.justReleased={};var c=!0,f=!1,h=void 0;try{for(var d,m=Object.keys(e)[Symbol.iterator]();!(c=(d=m.next()).done);c=!0){var v=d.value;this.buttonsDown[v]||(this.justReleased[v]=!0)}}catch(u){f=!0,h=u}finally{try{!c&&m["return"]&&m["return"]()}finally{if(f)throw h}}}}]),t}();r["default"]=i},{"gl-matrix":30}],18:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=t("gl-matrix").vec2,o=t("gl-matrix").vec3,i=function s(){var t=arguments.length<=0||void 0===arguments[0]?a.create():arguments[0],e=arguments.length<=1||void 0===arguments[1]?o.fromValues(Math.random(),Math.random(),Math.random()):arguments[1];n(this,s),this.velocity=a.clone(t),this.color=o.clone(e)};r["default"]=i},{"gl-matrix":30}],19:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("gl-matrix").mat4,i=t("gl-matrix").vec2,s=t("gl-matrix").vec4,l=4,u=function(){function t(e){var r=this;n(this,t),this.renderer=e,this.downscaledDimensions=i.scale(i.create(),e.dimensions,1/l),this.textures=[this.prepareTexture(this.renderer.dimensions),this.prepareTexture(this.renderer.dimensions)],this.framebuffers=this.textures.map(function(t){return r.prepareFramebuffer(t)}),this.downscaledTextures=[this.prepareTexture(this.downscaledDimensions),this.prepareTexture(this.downscaledDimensions)],this.downscaledFramebuffers=this.downscaledTextures.map(function(t){return r.prepareFramebuffer(t)}),this.lastFramebuffer=0,this.downscaled=!1;var a=[1,1,0,1,1,-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,-1,-1,0,0,0,1,-1,0,1,0];this.vertexBuffer=this.renderer.createVertexBuffer(a),this.renderer.gl.bindTexture(this.renderer.gl.TEXTURE_2D,null),this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,null)}return a(t,[{key:"prepareTexture",value:function(t){var e=this.renderer.gl.createTexture();return this.renderer.gl.bindTexture(this.renderer.gl.TEXTURE_2D,e),this.renderer.gl.texParameteri(this.renderer.gl.TEXTURE_2D,this.renderer.gl.TEXTURE_MIN_FILTER,this.renderer.gl.LINEAR),this.renderer.gl.texParameteri(this.renderer.gl.TEXTURE_2D,this.renderer.gl.TEXTURE_WRAP_S,this.renderer.gl.CLAMP_TO_EDGE),this.renderer.gl.texParameteri(this.renderer.gl.TEXTURE_2D,this.renderer.gl.TEXTURE_WRAP_T,this.renderer.gl.CLAMP_TO_EDGE),this.renderer.gl.texImage2D(this.renderer.gl.TEXTURE_2D,0,this.renderer.gl.RGBA,t[0],t[1],0,this.renderer.gl.RGBA,this.renderer.gl.UNSIGNED_BYTE,null),e}},{key:"prepareFramebuffer",value:function(t){var e=this.renderer.gl.createFramebuffer();return this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,e),this.renderer.gl.framebufferTexture2D(this.renderer.gl.FRAMEBUFFER,this.renderer.gl.COLOR_ATTACHMENT0,this.renderer.gl.TEXTURE_2D,t,0),e}},{key:"begin",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];this.downscaled=t,this.downscaled&&this.renderer.setViewport(s.fromValues(0,0,this.downscaledDimensions[0],this.downscaledDimensions[1])),this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,(this.downscaled?this.downscaledFramebuffers:this.framebuffers)[0]),this.renderer.clear(),this.lastFramebuffer=0}},{key:"end",value:function(){this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,null),this.downscaled&&this.renderer.setViewport(s.fromValues(0,0,this.renderer.dimensions[0],this.renderer.dimensions[1]))}},{key:"process",value:function(t){var e=(this.lastFramebuffer+1)%(this.downscaled?this.downscaledFramebuffers:this.framebuffers).length;this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,(this.downscaled?this.downscaledFramebuffers:this.framebuffers)[e]),this.downscaled&&this.renderer.setViewport(s.fromValues(0,0,this.downscaledDimensions[0],this.downscaledDimensions[1])),this.renderer.gl.bindTexture(this.renderer.gl.TEXTURE_2D,(this.downscaled?this.downscaledTextures:this.textures)[this.lastFramebuffer]),this.renderer.draw(t,o.create(),this.vertexBuffer,null,this.renderer.gl.TRIANGLES,6,!0),this.lastFramebuffer=e,this.downscaled&&this.renderer.setViewport(s.fromValues(0,0,this.renderer.dimensions[0],this.renderer.dimensions[1])),this.renderer.gl.bindTexture(this.renderer.gl.TEXTURE_2D,null),this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,null)}},{key:"draw",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];this.renderer.gl.bindTexture(this.renderer.gl.TEXTURE_2D,(this.downscaled?this.downscaledTextures:this.textures)[this.lastFramebuffer]),this.renderer.setViewport(s.fromValues(0,0,this.renderer.dimensions[0],this.renderer.dimensions[1])),e&&this.renderer.gl.blendFunc(this.renderer.gl.SRC_ALPHA,this.renderer.gl.ONE),this.renderer.draw(t,o.create(),this.vertexBuffer,null,this.renderer.gl.TRIANGLES,6,!0),e&&this.renderer.gl.blendFunc(this.renderer.gl.SRC_ALPHA,this.renderer.gl.ONE_MINUS_SRC_ALPHA),this.renderer.gl.bindTexture(this.renderer.gl.TEXTURE_2D,null)}}]),t}();r["default"]=u},{"gl-matrix":30}],20:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("./shaders/simple_shader"),s=n(i),l=t("./shaders/point_shader"),u=n(l),c=t("./shaders/particle_shader"),f=n(c),h=t("./shaders/texture_shader"),d=n(h),m=t("./shaders/desaturate_shader"),v=n(m),M=t("./shaders/blur_shader"),p=n(M),x=t("./shaders/threshold_shader"),b=n(x),S=t("./camera"),g=n(S),y=t("./post_processor"),I=n(y),w=t("gl-matrix").mat4,D=t("gl-matrix").vec2,F=t("gl-matrix").vec4,_=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?D.fromValues(1024,768):arguments[0];a(this,t),this.dimensions=D.clone(e),this.canvas=document.createElement("canvas"),this.canvas.width=this.dimensions[0],this.canvas.height=this.dimensions[1],this.viewport=F.fromValues(0,0,this.dimensions[0],this.dimensions[1]),document.body.appendChild(this.canvas),this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl"),this.gl.viewport(this.viewport[0],this.viewport[1],this.viewport[2],this.viewport[3]),this.gl.clearColor(0,0,0,1),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.projectionMatrix=w.create(),w.ortho(this.projectionMatrix,0,this.dimensions[0],this.dimensions[1],0,-1,1),this.shaders={simpleShader:new s["default"](this),pointShader:new u["default"](this),particleShader:new f["default"](this),textureShader:new d["default"](this),desaturateShader:new v["default"](this),blurShader:new p["default"](this),thresholdShader:new b["default"](this)},this.lastVertexBuffer=null,this.lastIndexBuffer=null,this.lastShaderProgram=null,this.enabledVertexAttributeArrays={},this.uniformValues=new Map,this.lineWidth=1,this.camera=new g["default"](D.scale(D.create(),this.dimensions,.5)),this.postProcessor=new I["default"](this)}return o(t,[{key:"createVertexBuffer",value:function(t){var e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.lastVertexBuffer=e,e}},{key:"fillVertexBuffer",value:function(t,e){t!==this.lastVertexBuffer&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.lastVertexBuffer=t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.STATIC_DRAW)}},{key:"createIndexBuffer",value:function(t){var e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),this.gl.STATIC_DRAW),this.lastIndexBuffer=e,e}},{key:"fillIndexBuffer",value:function(t,e){t!==this.lastIndexBuffer&&(this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t),this.lastIndexBuffer=t),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),this.gl.STATIC_DRAW)}},{key:"setViewport",value:function(t){t[0]===this.viewport[0]&&t[1]===this.viewport[1]&&t[2]===this.viewport[2]&&t[3]===this.viewport[3]||(this.gl.viewport(t[0],t[1],t[2],t[3]),this.viewport=F.clone(t))}},{key:"setLineWidth",value:function(t){t!==this.lineWidth&&this.gl.lineWidth(t)}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}},{key:"useShaderProgram",value:function(t){t!==this.lastShaderProgram&&(this.gl.useProgram(t),this.lastShaderProgram=t)}},{key:"enableVertexAttributeArray",value:function(t){this.enabledVertexAttributeArrays[t]||(this.gl.enableVertexAttribArray(t),this.enabledVertexAttributeArrays[t]=!0)}},{key:"setUniformValue",value:function(t,e,r){this.uniformValues.get(e)!==r&&(t.setUniformValue(this.gl,e,r),this.uniformValues.set(e,r))}},{key:"draw",value:function(t,e,r,n,a,o){var i=arguments.length<=6||void 0===arguments[6]?!1:arguments[6];r!==this.lastVertexBuffer&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.lastVertexBuffer=r),n!==this.lastIndexBuffer&&(this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,n),this.lastIndexBuffer=n),t.setVertexAttributes(this);var s=w.clone(this.camera.modelViewMatrix);w.multiply(s,s,e),t.modelViewMatrixValue=i?w.create():s,t.projectionMatrixValue=i?w.create():this.projectionMatrix,t.use(this),n?this.gl.drawElements(a,o,this.gl.UNSIGNED_SHORT,0):this.gl.drawArrays(a,0,o)}}]),t}();r["default"]=_},{"./camera":2,"./post_processor":19,"./shaders/blur_shader":22,"./shaders/desaturate_shader":23,"./shaders/particle_shader":24,"./shaders/point_shader":25,"./shaders/simple_shader":26,"./shaders/texture_shader":27,"./shaders/threshold_shader":28,"gl-matrix":30}],21:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=t("./vertex_attribute"),s=n(i),l=t("./matrix_vertex_attribute"),u=n(l),c=t("gl-matrix").mat4,f=[new s["default"]("vertexPosition")],h=[new u["default"]("modelViewMatrix",4),new u["default"]("projectionMatrix",4)],d=function(){function t(e,r,n){var o=arguments.length<=3||void 0===arguments[3]?[]:arguments[3],i=arguments.length<=4||void 0===arguments[4]?[]:arguments[4];a(this,t);var s=e.gl;this.vertexAttributes=f.concat(o),this.uniforms=h.concat(i),this.vertexShader=s.createShader(s.VERTEX_SHADER),s.shaderSource(this.vertexShader,r()),s.compileShader(this.vertexShader),s.getShaderParameter(this.vertexShader,s.COMPILE_STATUS)||alert(s.getShaderInfoLog(this.vertexShader)),this.fragmentShader=s.createShader(s.FRAGMENT_SHADER),s.shaderSource(this.fragmentShader,n()),s.compileShader(this.fragmentShader),s.getShaderParameter(this.vertexShader,s.COMPILE_STATUS)||alert(s.getShaderInfoLog(this.vertexShader)),this.shaderProgram=s.createProgram(),s.attachShader(this.shaderProgram,this.vertexShader),s.attachShader(this.shaderProgram,this.fragmentShader),s.linkProgram(this.shaderProgram),s.getProgramParameter(this.shaderProgram,s.LINK_STATUS)||alert(s.getProgramInfoLog(this.shaderProgram)),this.vertexSize=0;var l=!0,u=!1,d=void 0;try{for(var m,v=this.vertexAttributes[Symbol.iterator]();!(l=(m=v.next()).done);l=!0){var M=m.value;this[M.name]=s.getAttribLocation(this.shaderProgram,M.name),this.vertexSize+=M.byteCount}}catch(p){u=!0,d=p}finally{try{!l&&v["return"]&&v["return"]()}finally{if(u)throw d}}var x=!0,b=!1,S=void 0;try{for(var g,y=this.uniforms[Symbol.iterator]();!(x=(g=y.next()).done);x=!0){var I=g.value;this[I.name]=s.getUniformLocation(this.shaderProgram,I.name)}}catch(p){b=!0,S=p}finally{try{!x&&y["return"]&&y["return"]()}finally{if(b)throw S}}this.modelViewMatrixValue=c.create(),this.projectionMatrixValue=c.create()}return o(t,[{key:"setVertexAttributes",value:function(t){var e=0,r=!0,n=!1,a=void 0;try{for(var o,i=this.vertexAttributes[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var s=o.value;t.gl.vertexAttribPointer(this[s.name],s.elementCount,t.gl[s.elementType],!1,this.vertexSize,e),e+=s.byteCount}}catch(l){n=!0,a=l}finally{try{!r&&i["return"]&&i["return"]()}finally{if(n)throw a}}}},{key:"use",value:function(t){t.useShaderProgram(this.shaderProgram);var e=!0,r=!1,n=void 0;try{for(var a,o=this.vertexAttributes[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var i=a.value;t.enableVertexAttributeArray(this[i.name])}}catch(s){r=!0,n=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(r)throw n}}var l=!0,u=!1,c=void 0;try{for(var f,h=this.uniforms[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var d=f.value;t.setUniformValue(d,this[d.name],this[d.name+"Value"])}}catch(s){u=!0,c=s}finally{try{!l&&h["return"]&&h["return"]()}finally{if(u)throw c}}}}]),t}();r["default"]=d},{"./matrix_vertex_attribute":16,"./vertex_attribute":29,"gl-matrix":30}],22:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../vertex_attribute"),l=n(s),u=t("../shader"),c=n(u),f=t("gl-matrix").vec2,h=t("../../../shaders/blur.vert"),d=t("../../../shaders/blur.frag"),m=[new l["default"]("vertexTextureCoordinate",2)],v=[new l["default"]("sampler",1,"UNSIGNED_BYTE"),new l["default"]("textureSize",2),new l["default"]("direction",2),new l["default"]("radius",1)],M=function(t){function e(t){a(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t,h,d,m,v));return r.samplerValue=0,r.textureSizeValue=f.clone(t.dimensions),r.directionValue=[1,0],r.radiusValue=1,r}return i(e,t),e}(c["default"]);r["default"]=M},{"../../../shaders/blur.frag":40,"../../../shaders/blur.vert":41,"../shader":21,"../vertex_attribute":29,"gl-matrix":30}],23:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../vertex_attribute"),l=n(s),u=t("../shader"),c=n(u),f=t("../../../shaders/desaturate.vert"),h=t("../../../shaders/desaturate.frag"),d=[new l["default"]("vertexTextureCoordinate",2)],m=[new l["default"]("sampler",1,"UNSIGNED_BYTE"),new l["default"]("intensity",1)],v=function(t){function e(t){a(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t,f,h,d,m));return r.samplerValue=0,r.intensityValue=.5,r}return i(e,t),e}(c["default"]);r["default"]=v},{"../../../shaders/desaturate.frag":42,"../../../shaders/desaturate.vert":43,"../shader":21,"../vertex_attribute":29}],24:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../vertex_attribute"),l=n(s),u=t("../shader"),c=n(u),f=t("../../../shaders/particle.vert"),h=t("../../../shaders/particle.frag"),d=[new l["default"]("vertexVelocity"),new l["default"]("vertexColor",4),new l["default"]("timestamp",1)],m=[new l["default"]("currentTime",1),new l["default"]("lifetime",1),new l["default"]("pointSize",1)],v=function(t){function e(t){a(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t,f,h,d,m));return r.currentTimeValue=0,r.lifetimeValue=100,r.pointSizeValue=1.5,r}return i(e,t),e}(c["default"]);r["default"]=v},{"../../../shaders/particle.frag":44,"../../../shaders/particle.vert":45,"../shader":21,"../vertex_attribute":29}],25:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../vertex_attribute"),l=n(s),u=t("../shader"),c=n(u),f=t("../../../shaders/point.vert"),h=t("../../../shaders/point.frag"),d=[new l["default"]("vertexColor",4)],m=[new l["default"]("pointSize",1)],v=function(t){function e(t){a(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t,f,h,d,m));return r.pointSizeValue=1,r}return i(e,t),e}(c["default"]);r["default"]=v},{"../../../shaders/point.frag":46,"../../../shaders/point.vert":47,"../shader":21,"../vertex_attribute":29}],26:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../vertex_attribute"),l=n(s),u=t("../shader"),c=n(u),f=t("../../../shaders/simple.vert"),h=t("../../../shaders/simple.frag"),d=[new l["default"]("vertexColor",4)],m=function(t){function e(t){return a(this,e),o(this,Object.getPrototypeOf(e).call(this,t,f,h,d))}return i(e,t),e}(c["default"]);r["default"]=m},{"../../../shaders/simple.frag":48,"../../../shaders/simple.vert":49,"../shader":21,"../vertex_attribute":29}],27:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../vertex_attribute"),l=n(s),u=t("../shader"),c=n(u),f=t("../../../shaders/texture.vert"),h=t("../../../shaders/texture.frag"),d=[new l["default"]("vertexTextureCoordinate",2)],m=[new l["default"]("sampler",1,"UNSIGNED_BYTE")],v=function(t){function e(t){a(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t,f,h,d,m));return r.samplerValue=0,r}return i(e,t),e}(c["default"]);r["default"]=v},{"../../../shaders/texture.frag":50,"../../../shaders/texture.vert":51,"../shader":21,"../vertex_attribute":29}],28:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=t("../vertex_attribute"),l=n(s),u=t("../shader"),c=n(u),f=t("../../../shaders/threshold.vert"),h=t("../../../shaders/threshold.frag"),d=[new l["default"]("vertexTextureCoordinate",2)],m=[new l["default"]("sampler",1,"UNSIGNED_BYTE"),new l["default"]("threshold",1)],v=function(t){function e(t){a(this,e);var r=o(this,Object.getPrototypeOf(e).call(this,t,f,h,d,m));return r.samplerValue=0,r.thresholdValue=.7,r}return i(e,t),e}(c["default"]);r["default"]=v},{"../../../shaders/threshold.frag":52,"../../../shaders/threshold.vert":53,"../shader":21,"../vertex_attribute":29}],29:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e){var r=arguments.length<=1||void 0===arguments[1]?3:arguments[1],a=arguments.length<=2||void 0===arguments[2]?"FLOAT":arguments[2];switch(n(this,t),this.name=e,this.elementCount=r,this.elementType=a,this.uniformMethod="uniform"+this.elementCount+("FLOAT"===this.elementType?"f":"i")+(this.elementCount>1?"v":""),this.elementType){case"BYTE":this.byteCount=this.elementCount*Int8Array.BYTES_PER_ELEMENT;break;case"UNSIGNED_BYTE":this.byteCount=this.elementCount*Uint8Array.BYTES_PER_ELEMENT;break;case"SHORT":this.byteCount=this.elementCount*Int16Array.BYTES_PER_ELEMENT;break;case"UNSIGNED_SHORT":this.byteCount=this.elementCount*Uint16Array.BYTES_PER_ELEMENT;break;case"FIXED":this.byteCount=this.elementCount*Int32Array.BYTES_PER_ELEMENT;break;case"FLOAT":this.byteCount=this.elementCount*Float32Array.BYTES_PER_ELEMENT}}return a(t,[{key:"setUniformValue",value:function(t,e,r){t[this.uniformMethod](e,r)}}]),t}();r["default"]=o},{}],30:[function(t,e,r){r.glMatrix=t("./gl-matrix/common.js"),r.mat2=t("./gl-matrix/mat2.js"),r.mat2d=t("./gl-matrix/mat2d.js"),r.mat3=t("./gl-matrix/mat3.js"),r.mat4=t("./gl-matrix/mat4.js"),r.quat=t("./gl-matrix/quat.js"),r.vec2=t("./gl-matrix/vec2.js"),r.vec3=t("./gl-matrix/vec3.js"),r.vec4=t("./gl-matrix/vec4.js")},{"./gl-matrix/common.js":31,"./gl-matrix/mat2.js":32,"./gl-matrix/mat2d.js":33,"./gl-matrix/mat3.js":34,"./gl-matrix/mat4.js":35,"./gl-matrix/quat.js":36,"./gl-matrix/vec2.js":37,"./gl-matrix/vec3.js":38,"./gl-matrix/vec4.js":39}],31:[function(t,e,r){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var a=Math.PI/180;n.toRadian=function(t){return t*a},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},e.exports=n},{}],32:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,
t},a.fromValues=function(t,e,r,a){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=a,o},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*o-a*n;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-a*i,t[3]=r*i,t):null},a.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},a.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],l=r[1],u=r[2],c=r[3];return t[0]=n*s+o*l,t[1]=a*s+i*l,t[2]=n*u+o*c,t[3]=a*u+i*c,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*s,t[1]=a*l+i*s,t[2]=n*-s+o*l,t[3]=a*-s+i*l,t},a.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],l=r[1];return t[0]=n*s,t[1]=a*s,t[2]=o*l,t[3]=i*l,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},a.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},a.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-u)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},e.exports=a},{"./common.js":31}],33:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},a.fromValues=function(t,e,r,a,o,i){var s=new n.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=r,s[3]=a,s[4]=o,s[5]=i,s},a.set=function(t,e,r,n,a,o,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],l=r*o-n*a;return l?(l=1/l,t[0]=o*l,t[1]=-n*l,t[2]=-a*l,t[3]=r*l,t[4]=(a*s-o*i)*l,t[5]=(n*i-r*s)*l,t):null},a.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=r[0],c=r[1],f=r[2],h=r[3],d=r[4],m=r[5];return t[0]=n*u+o*c,t[1]=a*u+i*c,t[2]=n*f+o*h,t[3]=a*f+i*h,t[4]=n*d+o*m+s,t[5]=a*d+i*m+l,t},a.mul=a.multiply,a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=Math.sin(r),c=Math.cos(r);return t[0]=n*c+o*u,t[1]=a*c+i*u,t[2]=n*-u+o*c,t[3]=a*-u+i*c,t[4]=s,t[5]=l,t},a.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=r[0],c=r[1];return t[0]=n*u,t[1]=a*u,t[2]=o*c,t[3]=i*c,t[4]=s,t[5]=l,t},a.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=r[0],c=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=n*u+o*c+s,t[5]=a*u+i*c+l,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},a.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=t[4],l=t[5],u=e[0],c=e[1],f=e[2],h=e[3],d=e[4],m=e[5];return Math.abs(r-u)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(a-c)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-f)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-h)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-d)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(l-m)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))},e.exports=a},{"./common.js":31}],34:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.clone=function(t){var e=new n.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromValues=function(t,e,r,a,o,i,s,l,u){var c=new n.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=a,c[4]=o,c[5]=i,c[6]=s,c[7]=l,c[8]=u,c},a.set=function(t,e,r,n,a,o,i,s,l,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=s,t[7]=l,t[8]=u,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=c*i-s*u,h=-c*o+s*l,d=u*o-i*l,m=r*f+n*h+a*d;return m?(m=1/m,t[0]=f*m,t[1]=(-c*n+a*u)*m,t[2]=(s*n-a*i)*m,t[3]=h*m,t[4]=(c*r-a*l)*m,t[5]=(-s*r+a*o)*m,t[6]=d*m,t[7]=(-u*r+n*l)*m,t[8]=(i*r-n*o)*m,t):null},a.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return t[0]=i*c-s*u,t[1]=a*u-n*c,t[2]=n*s-a*i,t[3]=s*l-o*c,t[4]=r*c-a*l,t[5]=a*o-r*s,t[6]=o*u-i*l,t[7]=n*l-r*u,t[8]=r*i-n*o,t},a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],s=t[6],l=t[7],u=t[8];return e*(u*o-i*l)+r*(-u*a+i*s)+n*(l*a-o*s)},a.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=r[0],d=r[1],m=r[2],v=r[3],M=r[4],p=r[5],x=r[6],b=r[7],S=r[8];return t[0]=h*n+d*i+m*u,t[1]=h*a+d*s+m*c,t[2]=h*o+d*l+m*f,t[3]=v*n+M*i+p*u,t[4]=v*a+M*s+p*c,t[5]=v*o+M*l+p*f,t[6]=x*n+b*i+S*u,t[7]=x*a+b*s+S*c,t[8]=x*o+b*l+S*f,t},a.mul=a.multiply,a.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=r[0],d=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=s,t[5]=l,t[6]=h*n+d*i+u,t[7]=h*a+d*s+c,t[8]=h*o+d*l+f,t},a.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*n+h*i,t[1]=d*a+h*s,t[2]=d*o+h*l,t[3]=d*i-h*n,t[4]=d*s-h*a,t[5]=d*l-h*o,t[6]=u,t[7]=c,t[8]=f,t},a.scale=function(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},a.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,s=n+n,l=a+a,u=r*i,c=n*i,f=n*s,h=a*i,d=a*s,m=a*l,v=o*i,M=o*s,p=o*l;return t[0]=1-f-m,t[3]=c-p,t[6]=h+M,t[1]=c+p,t[4]=1-u-m,t[7]=d-v,t[2]=h-M,t[5]=d+v,t[8]=1-u-f,t},a.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],m=e[12],v=e[13],M=e[14],p=e[15],x=r*s-n*i,b=r*l-a*i,S=r*u-o*i,g=n*l-a*s,y=n*u-o*s,I=a*u-o*l,w=c*v-f*m,D=c*M-h*m,F=c*p-d*m,_=f*M-h*v,E=f*p-d*v,P=h*p-d*M,O=x*P-b*E+S*_+g*F-y*D+I*w;return O?(O=1/O,t[0]=(s*P-l*E+u*_)*O,t[1]=(l*F-i*P-u*D)*O,t[2]=(i*E-s*F+u*w)*O,t[3]=(a*E-n*P-o*_)*O,t[4]=(r*P-a*F+o*D)*O,t[5]=(n*F-r*E-o*w)*O,t[6]=(v*I-M*y+p*g)*O,t[7]=(M*S-m*I-p*b)*O,t[8]=(m*y-v*S+p*x)*O,t):null},a.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=e[0],d=e[1],m=e[2],v=e[3],M=e[4],p=e[5],x=t[6],b=e[7],S=e[8];return Math.abs(r-h)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(a-d)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-m)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(i-v)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(s-M)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(l-p)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(u-x)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-b)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-S)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(S))},e.exports=a},{"./common.js":31}],35:[function(t,e,r){var n=t("./common.js"),a={scalar:{},SIMD:{}};a.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.clone=function(t){var e=new n.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.fromValues=function(t,e,r,a,o,i,s,l,u,c,f,h,d,m,v,M){var p=new n.ARRAY_TYPE(16);return p[0]=t,p[1]=e,p[2]=r,p[3]=a,p[4]=o,p[5]=i,p[6]=s,p[7]=l,p[8]=u,p[9]=c,p[10]=f,p[11]=h,p[12]=d,p[13]=m,p[14]=v,p[15]=M,p},a.set=function(t,e,r,n,a,o,i,s,l,u,c,f,h,d,m,v,M){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=s,t[7]=l,t[8]=u,t[9]=c,t[10]=f,t[11]=h,t[12]=d,t[13]=m,t[14]=v,t[15]=M,t},a.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.scalar.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],o=e[6],i=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=a,t[13]=i,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},a.SIMD.transpose=function(t,e){var r,n,a,o,i,s,l,u,c,f;return r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),i=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,o,0,1,4,5),l=SIMD.Float32x4.shuffle(i,s,0,2,4,6),u=SIMD.Float32x4.shuffle(i,s,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,u),i=SIMD.Float32x4.shuffle(r,n,2,3,6,7),s=SIMD.Float32x4.shuffle(a,o,2,3,6,7),c=SIMD.Float32x4.shuffle(i,s,0,2,4,6),f=SIMD.Float32x4.shuffle(i,s,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,f),t},a.transpose=n.USE_SIMD?a.SIMD.transpose:a.scalar.transpose,a.scalar.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],m=e[12],v=e[13],M=e[14],p=e[15],x=r*s-n*i,b=r*l-a*i,S=r*u-o*i,g=n*l-a*s,y=n*u-o*s,I=a*u-o*l,w=c*v-f*m,D=c*M-h*m,F=c*p-d*m,_=f*M-h*v,E=f*p-d*v,P=h*p-d*M,O=x*P-b*E+S*_+g*F-y*D+I*w;return O?(O=1/O,t[0]=(s*P-l*E+u*_)*O,t[1]=(a*E-n*P-o*_)*O,t[2]=(v*I-M*y+p*g)*O,t[3]=(h*y-f*I-d*g)*O,t[4]=(l*F-i*P-u*D)*O,t[5]=(r*P-a*F+o*D)*O,t[6]=(M*S-m*I-p*b)*O,t[7]=(c*I-h*S+d*b)*O,t[8]=(i*E-s*F+u*w)*O,t[9]=(n*F-r*E-o*w)*O,t[10]=(m*y-v*S+p*x)*O,t[11]=(f*S-c*y-d*x)*O,t[12]=(s*D-i*_-l*w)*O,t[13]=(r*_-n*D+a*w)*O,t[14]=(v*b-m*g-M*x)*O,t[15]=(c*g-f*b+h*x)*O,t):null},a.SIMD.invert=function(t,e){var r,n,a,o,i,s,l,u,c,f,h=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),m=SIMD.Float32x4.load(e,8),v=SIMD.Float32x4.load(e,12);return i=SIMD.Float32x4.shuffle(h,d,0,1,4,5),n=SIMD.Float32x4.shuffle(m,v,0,1,4,5),r=SIMD.Float32x4.shuffle(i,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,i,1,3,5,7),i=SIMD.Float32x4.shuffle(h,d,2,3,6,7),o=SIMD.Float32x4.shuffle(m,v,2,3,6,7),a=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(a,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.mul(n,i),l=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(n,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),c=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),s),u=SIMD.Float32x4.mul(r,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(a,i)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.mul(r,n),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),c),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(a,i)),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(a,i)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),u),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(a,i),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.mul(r,a),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,i)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),c),f=SIMD.Float32x4.mul(r,s),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),i=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(i,i))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,u)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,c)),t):null},a.invert=n.USE_SIMD?a.SIMD.invert:a.scalar.invert,a.scalar.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],m=e[12],v=e[13],M=e[14],p=e[15];return t[0]=s*(h*p-d*M)-f*(l*p-u*M)+v*(l*d-u*h),t[1]=-(n*(h*p-d*M)-f*(a*p-o*M)+v*(a*d-o*h)),t[2]=n*(l*p-u*M)-s*(a*p-o*M)+v*(a*u-o*l),t[3]=-(n*(l*d-u*h)-s*(a*d-o*h)+f*(a*u-o*l)),t[4]=-(i*(h*p-d*M)-c*(l*p-u*M)+m*(l*d-u*h)),t[5]=r*(h*p-d*M)-c*(a*p-o*M)+m*(a*d-o*h),t[6]=-(r*(l*p-u*M)-i*(a*p-o*M)+m*(a*u-o*l)),t[7]=r*(l*d-u*h)-i*(a*d-o*h)+c*(a*u-o*l),t[8]=i*(f*p-d*v)-c*(s*p-u*v)+m*(s*d-u*f),t[9]=-(r*(f*p-d*v)-c*(n*p-o*v)+m*(n*d-o*f)),t[10]=r*(s*p-u*v)-i*(n*p-o*v)+m*(n*u-o*s),t[11]=-(r*(s*d-u*f)-i*(n*d-o*f)+c*(n*u-o*s)),t[12]=-(i*(f*M-h*v)-c*(s*M-l*v)+m*(s*h-l*f)),t[13]=r*(f*M-h*v)-c*(n*M-a*v)+m*(n*h-a*f),t[14]=-(r*(s*M-l*v)-i*(n*M-a*v)+m*(n*l-a*s)),t[15]=r*(s*h-l*f)-i*(n*h-a*f)+c*(n*l-a*s),t},a.SIMD.adjoint=function(t,e){var r,n,a,o,i,s,l,u,c,f,h,d,m,r=SIMD.Float32x4.load(e,0),n=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(r,n,0,1,4,5),s=SIMD.Float32x4.shuffle(a,o,0,1,4,5),i=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(r,n,2,3,6,7),u=SIMD.Float32x4.shuffle(a,o,2,3,6,7),l=SIMD.Float32x4.shuffle(c,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,c,1,3,5,7),c=SIMD.Float32x4.mul(l,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.mul(s,c),h=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.mul(s,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),m=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),d=SIMD.Float32x4.mul(i,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(i,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),d),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),m),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),d),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(l,c)),c=SIMD.Float32x4.mul(i,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(i,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),m),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,m),t},a.adjoint=n.USE_SIMD?a.SIMD.adjoint:a.scalar.adjoint,a.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],s=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11],d=t[12],m=t[13],v=t[14],M=t[15],p=e*i-r*o,x=e*s-n*o,b=e*l-a*o,S=r*s-n*i,g=r*l-a*i,y=n*l-a*s,I=u*m-c*d,w=u*v-f*d,D=u*M-h*d,F=c*v-f*m,_=c*M-h*m,E=f*M-h*v;return p*E-x*_+b*F+S*D-g*w+y*I},a.SIMD.multiply=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(r,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,0,l);var u=SIMD.Float32x4.load(r,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));SIMD.Float32x4.store(t,4,c);var f=SIMD.Float32x4.load(r,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));SIMD.Float32x4.store(t,8,h);var d=SIMD.Float32x4.load(r,12),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),a),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,m),t},a.scalar.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],d=e[10],m=e[11],v=e[12],M=e[13],p=e[14],x=e[15],b=r[0],S=r[1],g=r[2],y=r[3];return t[0]=b*n+S*s+g*f+y*v,t[1]=b*a+S*l+g*h+y*M,t[2]=b*o+S*u+g*d+y*p,t[3]=b*i+S*c+g*m+y*x,b=r[4],S=r[5],g=r[6],y=r[7],t[4]=b*n+S*s+g*f+y*v,t[5]=b*a+S*l+g*h+y*M,t[6]=b*o+S*u+g*d+y*p,t[7]=b*i+S*c+g*m+y*x,b=r[8],S=r[9],g=r[10],y=r[11],t[8]=b*n+S*s+g*f+y*v,t[9]=b*a+S*l+g*h+y*M,t[10]=b*o+S*u+g*d+y*p,t[11]=b*i+S*c+g*m+y*x,b=r[12],S=r[13],g=r[14],y=r[15],t[12]=b*n+S*s+g*f+y*v,t[13]=b*a+S*l+g*h+y*M,t[14]=b*o+S*u+g*d+y*p,t[15]=b*i+S*c+g*m+y*x,t},a.multiply=n.USE_SIMD?a.SIMD.multiply:a.scalar.multiply,a.mul=a.multiply,a.scalar.translate=function(t,e,r){var n,a,o,i,s,l,u,c,f,h,d,m,v=r[0],M=r[1],p=r[2];return e===t?(t[12]=e[0]*v+e[4]*M+e[8]*p+e[12],t[13]=e[1]*v+e[5]*M+e[9]*p+e[13],t[14]=e[2]*v+e[6]*M+e[10]*p+e[14],t[15]=e[3]*v+e[7]*M+e[11]*p+e[15]):(n=e[0],a=e[1],o=e[2],i=e[3],s=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],d=e[10],m=e[11],t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=f,t[9]=h,t[10]=d,t[11]=m,t[12]=n*v+s*M+f*p+e[12],t[13]=a*v+l*M+h*p+e[13],t[14]=o*v+u*M+d*p+e[14],t[15]=i*v+c*M+m*p+e[15]),t},a.SIMD.translate=function(t,e,r){var n=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),i=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(r[0],r[1],r[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0)),a=SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(s,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var l=SIMD.Float32x4.add(n,SIMD.Float32x4.add(a,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,l),t},a.translate=n.USE_SIMD?a.SIMD.translate:a.scalar.translate,a.scalar.scale=function(t,e,r){var n=r[0],a=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.SIMD.scale=function(t,e,r){var n,a,o,i=SIMD.Float32x4(r[0],r[1],r[2],0);return n=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,0,0,0,0))),a=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(a,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.scale=n.USE_SIMD?a.SIMD.scale:a.scalar.scale,a.rotate=function(t,e,r,a){var o,i,s,l,u,c,f,h,d,m,v,M,p,x,b,S,g,y,I,w,D,F,_,E,P=a[0],O=a[1],T=a[2],A=Math.sqrt(P*P+O*O+T*T);return Math.abs(A)<n.EPSILON?null:(A=1/A,P*=A,O*=A,T*=A,o=Math.sin(r),i=Math.cos(r),s=1-i,l=e[0],u=e[1],c=e[2],f=e[3],h=e[4],d=e[5],m=e[6],v=e[7],M=e[8],p=e[9],x=e[10],b=e[11],S=P*P*s+i,g=O*P*s+T*o,y=T*P*s-O*o,I=P*O*s-T*o,w=O*O*s+i,D=T*O*s+P*o,F=P*T*s+O*o,_=O*T*s-P*o,E=T*T*s+i,t[0]=l*S+h*g+M*y,t[1]=u*S+d*g+p*y,t[2]=c*S+m*g+x*y,t[3]=f*S+v*g+b*y,t[4]=l*I+h*w+M*D,t[5]=u*I+d*w+p*D,t[6]=c*I+m*w+x*D,t[7]=f*I+v*w+b*D,t[8]=l*F+h*_+M*E,t[9]=u*F+d*_+p*E,t[10]=c*F+m*_+x*E,t[11]=f*F+v*_+b*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},a.scalar.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[4],i=e[5],s=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*a+u*n,t[5]=i*a+c*n,t[6]=s*a+f*n,t[7]=l*a+h*n,t[8]=u*a-o*n,t[9]=c*a-i*n,t[10]=f*a-s*n,t[11]=h*a-l*n,t},a.SIMD.rotateX=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),t},a.rotateX=n.USE_SIMD?a.SIMD.rotateX:a.scalar.rotateX,a.scalar.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],s=e[2],l=e[3],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a-u*n,t[1]=i*a-c*n,t[2]=s*a-f*n,t[3]=l*a-h*n,t[8]=o*n+u*a,t[9]=i*n+c*a,t[10]=s*n+f*a,t[11]=l*n+h*a,t},a.SIMD.rotateY=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,a))),t},a.rotateY=n.USE_SIMD?a.SIMD.rotateY:a.scalar.rotateY,a.scalar.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],s=e[2],l=e[3],u=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*a+u*n,t[1]=i*a+c*n,t[2]=s*a+f*n,t[3]=l*a+h*n,t[4]=u*a-o*n,t[5]=c*a-i*n,t[6]=f*a-s*n,t[7]=h*a-l*n,t},a.SIMD.rotateZ=function(t,e,r){var n=SIMD.Float32x4.splat(Math.sin(r)),a=SIMD.Float32x4.splat(Math.cos(r));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),SIMD.Float32x4.mul(o,n))),t},a.rotateZ=n.USE_SIMD?a.SIMD.rotateZ:a.scalar.rotateZ,a.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e,r){var a,o,i,s=r[0],l=r[1],u=r[2],c=Math.sqrt(s*s+l*l+u*u);return Math.abs(c)<n.EPSILON?null:(c=1/c,s*=c,l*=c,u*=c,a=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=s*s*i+o,t[1]=l*s*i+u*a,t[2]=u*s*i-l*a,t[3]=0,t[4]=s*l*i-u*a,t[5]=l*l*i+o,t[6]=u*l*i+s*a,t[7]=0,t[8]=s*u*i+l*a,t[9]=l*u*i-s*a,t[10]=u*u*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},a.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotationTranslation=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=n+n,l=a+a,u=o+o,c=n*s,f=n*l,h=n*u,d=a*l,m=a*u,v=o*u,M=i*s,p=i*l,x=i*u;return t[0]=1-(d+v),t[1]=f+x,t[2]=h-p,t[3]=0,t[4]=f-x,t[5]=1-(c+v),t[6]=m+M,t[7]=0,t[8]=h+p,t[9]=m-M,t[10]=1-(c+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},a.getRotation=function(t,e){var r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},a.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=e[3],l=a+a,u=o+o,c=i+i,f=a*l,h=a*u,d=a*c,m=o*u,v=o*c,M=i*c,p=s*l,x=s*u,b=s*c,S=n[0],g=n[1],y=n[2];return t[0]=(1-(m+M))*S,t[1]=(h+b)*S,t[2]=(d-x)*S,t[3]=0,t[4]=(h-b)*g,t[5]=(1-(f+M))*g,t[6]=(v+p)*g,t[7]=0,t[8]=(d+x)*y,t[9]=(v-p)*y,t[10]=(1-(f+m))*y,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},a.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var o=e[0],i=e[1],s=e[2],l=e[3],u=o+o,c=i+i,f=s+s,h=o*u,d=o*c,m=o*f,v=i*c,M=i*f,p=s*f,x=l*u,b=l*c,S=l*f,g=n[0],y=n[1],I=n[2],w=a[0],D=a[1],F=a[2];return t[0]=(1-(v+p))*g,t[1]=(d+S)*g,t[2]=(m-b)*g,t[3]=0,t[4]=(d-S)*y,t[5]=(1-(h+p))*y,t[6]=(M+x)*y,t[7]=0,t[8]=(m+b)*I,t[9]=(M-x)*I,t[10]=(1-(h+v))*I,t[11]=0,t[12]=r[0]+w-(t[0]*w+t[4]*D+t[8]*F),t[13]=r[1]+D-(t[1]*w+t[5]*D+t[9]*F),t[14]=r[2]+F-(t[2]*w+t[6]*D+t[10]*F),t[15]=1,t},a.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,s=n+n,l=a+a,u=r*i,c=n*i,f=n*s,h=a*i,d=a*s,m=a*l,v=o*i,M=o*s,p=o*l;return t[0]=1-f-m,t[1]=c+p,t[2]=h-M,t[3]=0,t[4]=c-p,t[5]=1-u-m,t[6]=d+v,t[7]=0,t[8]=h+M,t[9]=d-v,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.frustum=function(t,e,r,n,a,o,i){var s=1/(r-e),l=1/(a-n),u=1/(o-i);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(a+n)*l,t[10]=(i+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*u,t[15]=0,t},a.perspective=function(t,e,r,n,a){var o=1/Math.tan(e/2),i=1/(n-a);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*i,t[15]=0,t},a.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(i+s),u=2/(a+o);
return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((i-s)*l*.5),t[9]=(a-o)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},a.ortho=function(t,e,r,n,a,o,i){var s=1/(e-r),l=1/(n-a),u=1/(o-i);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*l,t[14]=(i+o)*u,t[15]=1,t},a.lookAt=function(t,e,r,o){var i,s,l,u,c,f,h,d,m,v,M=e[0],p=e[1],x=e[2],b=o[0],S=o[1],g=o[2],y=r[0],I=r[1],w=r[2];return Math.abs(M-y)<n.EPSILON&&Math.abs(p-I)<n.EPSILON&&Math.abs(x-w)<n.EPSILON?a.identity(t):(h=M-y,d=p-I,m=x-w,v=1/Math.sqrt(h*h+d*d+m*m),h*=v,d*=v,m*=v,i=S*m-g*d,s=g*h-b*m,l=b*d-S*h,v=Math.sqrt(i*i+s*s+l*l),v?(v=1/v,i*=v,s*=v,l*=v):(i=0,s=0,l=0),u=d*l-m*s,c=m*i-h*l,f=h*s-d*i,v=Math.sqrt(u*u+c*c+f*f),v?(v=1/v,u*=v,c*=v,f*=v):(u=0,c=0,f=0),t[0]=i,t[1]=u,t[2]=h,t[3]=0,t[4]=s,t[5]=c,t[6]=d,t[7]=0,t[8]=l,t[9]=f,t[10]=m,t[11]=0,t[12]=-(i*M+s*p+l*x),t[13]=-(u*M+c*p+f*x),t[14]=-(h*M+d*p+m*x),t[15]=1,t)},a.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},a.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t},a.sub=a.subtract,a.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},a.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],d=t[10],m=t[11],v=t[12],M=t[13],p=t[14],x=t[15],b=e[0],S=e[1],g=e[2],y=e[3],I=e[4],w=e[5],D=e[6],F=e[7],_=e[8],E=e[9],P=e[10],O=e[11],T=e[12],A=e[13],j=e[14],R=e[15];return Math.abs(r-b)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(a-S)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(o-g)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(i-y)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(s-I)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(l-w)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(u-D)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(c-F)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(f-_)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(h-E)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-P)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(m-O)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(v-T)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(M-A)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(A))&&Math.abs(p-j)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(j))&&Math.abs(x-R)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(R))},e.exports=a},{"./common.js":31}],36:[function(t,e,r){var n=t("./common.js"),a=t("./mat3.js"),o=t("./vec3.js"),i=t("./vec4.js"),s={};s.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(n,a,i){var l=o.dot(a,i);return-.999999>l?(o.cross(t,e,a),o.length(t)<1e-6&&o.cross(t,r,a),o.normalize(t,t),s.setAxisAngle(n,t,Math.PI),n):l>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,a,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+l,s.normalize(n,n))}}(),s.setAxes=function(){var t=a.create();return function(e,r,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=i.clone,s.fromValues=i.fromValues,s.copy=i.copy,s.set=i.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,r){r=.5*r;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},s.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r},s.add=i.add,s.multiply=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],s=r[0],l=r[1],u=r[2],c=r[3];return t[0]=n*c+i*s+a*u-o*l,t[1]=a*c+i*l+o*s-n*u,t[2]=o*c+i*u+n*l-a*s,t[3]=i*c-n*s-a*l-o*u,t},s.mul=s.multiply,s.scale=i.scale,s.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+i*s,t[1]=a*l+o*s,t[2]=o*l-a*s,t[3]=i*l-n*s,t},s.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l-o*s,t[1]=a*l+i*s,t[2]=o*l+n*s,t[3]=i*l-a*s,t},s.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],s=Math.sin(r),l=Math.cos(r);return t[0]=n*l+a*s,t[1]=a*l-n*s,t[2]=o*l+i*s,t[3]=i*l-o*s,t},s.calculateW=function(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t},s.dot=i.dot,s.lerp=i.lerp,s.slerp=function(t,e,r,n){var a,o,i,s,l,u=e[0],c=e[1],f=e[2],h=e[3],d=r[0],m=r[1],v=r[2],M=r[3];return o=u*d+c*m+f*v+h*M,0>o&&(o=-o,d=-d,m=-m,v=-v,M=-M),1-o>1e-6?(a=Math.acos(o),i=Math.sin(a),s=Math.sin((1-n)*a)/i,l=Math.sin(n*a)/i):(s=1-n,l=n),t[0]=s*u+l*d,t[1]=s*c+l*m,t[2]=s*f+l*v,t[3]=s*h+l*M,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(r,n,a,o,i,l){return s.slerp(t,n,i,l),s.slerp(e,a,o,l),s.slerp(r,t,e,2*l*(1-l)),r}}(),s.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o,s=i?1/i:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-a*s,t[3]=o*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=i.length,s.len=s.length,s.squaredLength=i.squaredLength,s.sqrLen=s.squaredLength,s.normalize=i.normalize,s.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var o=(a+1)%3,i=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*o+o]-e[3*i+i]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+a]+e[3*a+o])*r,t[i]=(e[3*i+a]+e[3*a+i])*r}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=i.exactEquals,s.equals=i.equals,e.exports=s},{"./common.js":31,"./mat3.js":34,"./vec3.js":38,"./vec4.js":39}],37:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},a.fromValues=function(t,e){var r=new n.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},a.set=function(t,e,r){return t[0]=e,t[1]=r,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},a.lerp=function(t,e,r,n){var a=e[0],o=e[1];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},a.transformMat2=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t},a.transformMat2d=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var s,l;for(r||(r=2),n||(n=0),l=a?Math.min(a*r+n,e.length):e.length,s=n;l>s;s+=r)t[0]=e[s],t[1]=e[s+1],o(t,t,i),e[s]=t[0],e[s+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a.equals=function(t,e){var r=t[0],a=t[1],o=e[0],i=e[1];return Math.abs(r-o)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-i)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))},e.exports=a},{"./common.js":31}],38:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,r){var a=new n.ARRAY_TYPE(3);return a[0]=t,a[1]=e,a[2]=r,a},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(r*r+n*n+a*a)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],o=r*r+n*n+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],l=r[2];return t[0]=a*l-o*s,t[1]=o*i-n*l,t[2]=n*s-a*i,t},a.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t},a.hermite=function(t,e,r,n,a,o){var i=o*o,s=i*(2*o-3)+1,l=i*(o-2)+o,u=i*(o-1),c=i*(3-2*o);return t[0]=e[0]*s+r[0]*l+n[0]*u+a[0]*c,t[1]=e[1]*s+r[1]*l+n[1]*u+a[1]*c,t[2]=e[2]*s+r[2]*l+n[2]*u+a[2]*c,t},a.bezier=function(t,e,r,n,a,o){var i=1-o,s=i*i,l=o*o,u=s*i,c=3*o*s,f=3*l*i,h=l*o;return t[0]=e[0]*u+r[0]*c+n[0]*f+a[0]*h,t[1]=e[1]*u+r[1]*c+n[1]*f+a[1]*h,t[2]=e[2]*u+r[2]*c+n[2]*f+a[2]*h,t},a.random=function(t,e){e=e||1;var r=2*n.RANDOM()*Math.PI,a=2*n.RANDOM()-1,o=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=a*e,t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[3]*n+r[7]*a+r[11]*o+r[15];return i=i||1,t[0]=(r[0]*n+r[4]*a+r[8]*o+r[12])/i,t[1]=(r[1]*n+r[5]*a+r[9]*o+r[13])/i,t[2]=(r[2]*n+r[6]*a+r[10]*o+r[14])/i,t},a.transformMat3=function(t,e,r){var n=e[0],a=e[1],o=e[2];return t[0]=n*r[0]+a*r[3]+o*r[6],t[1]=n*r[1]+a*r[4]+o*r[7],t[2]=n*r[2]+a*r[5]+o*r[8],t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*a,f=u*a+l*n-i*o,h=u*o+i*a-s*n,d=-i*n-s*a-l*o;return t[0]=c*u+d*-i+f*-l-h*-s,t[1]=f*u+d*-s+h*-i-c*-l,t[2]=h*u+d*-l+c*-s-f*-i,t},a.rotateX=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0],o[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),o[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.rotateY=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),o[1]=a[1],o[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.rotateZ=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),o[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),o[2]=a[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var s,l;for(r||(r=3),n||(n=0),l=a?Math.min(a*r+n,e.length):e.length,s=n;l>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,i),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),a.angle=function(t,e){var r=a.fromValues(t[0],t[1],t[2]),n=a.fromValues(e[0],e[1],e[2]);a.normalize(r,r),a.normalize(n,n);var o=a.dot(r,n);return o>1?0:Math.acos(o)},a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=e[0],s=e[1],l=e[2];return Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(a-s)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},e.exports=a},{"./common.js":31}],39:[function(t,e,r){var n=t("./common.js"),a={};a.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new n.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,r,a){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=a,o},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},a.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},a.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},a.div=a.divide,a.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},a.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},a.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+a*a+o*o)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+a*a+o*o},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.sqrt(e*e+r*r+n*n+a*a)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},a.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=r*i,t[1]=n*i,t[2]=a*i,t[3]=o*i),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],s=e[3];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t[3]=s+n*(r[3]-s),t},a.random=function(t,e){return e=e||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),a.normalize(t,t),a.scale(t,t,e),t},a.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*o+r[12]*i,t[1]=r[1]*n+r[5]*a+r[9]*o+r[13]*i,t[2]=r[2]*n+r[6]*a+r[10]*o+r[14]*i,t[3]=r[3]*n+r[7]*a+r[11]*o+r[15]*i,t},a.transformQuat=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*a,f=u*a+l*n-i*o,h=u*o+i*a-s*n,d=-i*n-s*a-l*o;return t[0]=c*u+d*-i+f*-l-h*-s,t[1]=f*u+d*-s+h*-i-c*-l,t[2]=h*u+d*-l+c*-s-f*-i,t[3]=e[3],t},a.forEach=function(){var t=a.create();return function(e,r,n,a,o,i){var s,l;for(r||(r=4),n||(n=0),l=a?Math.min(a*r+n,e.length):e.length,s=n;l>s;s+=r)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,i),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.equals=function(t,e){var r=t[0],a=t[1],o=t[2],i=t[3],s=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-l)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-u)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(i-c)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))},e.exports=a},{"./common.js":31}],40:[function(t,e,r){e.exports=function(t){var e="precision mediump float; \n \nconst float pi = 3.14159265; \n \nuniform sampler2D sampler; \nuniform vec2 textureSize; \nuniform vec2 direction; \nuniform float radius; \n \nvarying vec2 textureCoordinate; \n \nvoid main() { \n  vec2 textureStep = (1.0 / textureSize) * direction * radius; \n  vec4 color = vec4(0.0); \n \n  color += texture2D(sampler, textureCoordinate - 4.0 * textureStep) * 0.0162162162; \n  color += texture2D(sampler, textureCoordinate - 3.0 * textureStep) * 0.0540540541; \n  color += texture2D(sampler, textureCoordinate - 2.0 * textureStep) * 0.1216216216; \n  color += texture2D(sampler, textureCoordinate - 1.0 * textureStep) * 0.1945945946; \n  color += texture2D(sampler, textureCoordinate + 0.0 * textureStep) * 0.2270270270; \n  color += texture2D(sampler, textureCoordinate + 1.0 * textureStep) * 0.1945945946; \n  color += texture2D(sampler, textureCoordinate + 2.0 * textureStep) * 0.1216216216; \n  color += texture2D(sampler, textureCoordinate + 3.0 * textureStep) * 0.0540540541; \n  color += texture2D(sampler, textureCoordinate + 4.0 * textureStep) * 0.0162162162; \n \n  gl_FragColor = color; \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],41:[function(t,e,r){e.exports=function(t){var e="uniform mat4 modelViewMatrix; \nuniform mat4 projectionMatrix; \n \nattribute vec3 vertexPosition; \nattribute vec2 vertexTextureCoordinate; \n \nvarying vec2 textureCoordinate; \n \nvoid main() { \n  textureCoordinate = vertexTextureCoordinate; \n \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0); \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],42:[function(t,e,r){e.exports=function(t){var e="precision mediump float; \n \nuniform sampler2D sampler; \nuniform float intensity; \n \nvarying vec2 textureCoordinate; \n \nvoid main() { \n  vec4 color = texture2D(sampler, textureCoordinate); \n  float luminance = dot(color.rgb, vec3(0.3, 0.59, 0.11)); \n  color.rgb = mix(color.rgb, vec3(luminance), intensity); \n \n  gl_FragColor = color; \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],43:[function(t,e,r){arguments[4][41][0].apply(r,arguments)},{dup:41}],44:[function(t,e,r){e.exports=function(t){var e="precision mediump float; \n \nvarying vec4 color; \n \nvoid main() { \n  gl_FragColor = color; \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],45:[function(t,e,r){e.exports=function(t){var e="uniform mat4 modelViewMatrix; \nuniform mat4 projectionMatrix; \n \nuniform float currentTime; \nuniform float lifetime; \nuniform float pointSize; \n \nattribute vec3 vertexPosition; \nattribute vec3 vertexVelocity; \nattribute vec4 vertexColor; \nattribute float timestamp; \n \nvarying vec4 color; \n \nvoid main() { \n  color = vertexColor; \n  color.a = 1.0 - (currentTime - timestamp) / lifetime; \n \n  vec3 currentPosition = vec3(vertexPosition + vertexVelocity * (currentTime - timestamp)); \n \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(currentPosition, 1.0); \n  gl_PointSize = pointSize; \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],46:[function(t,e,r){arguments[4][44][0].apply(r,arguments)},{dup:44}],47:[function(t,e,r){e.exports=function(t){var e="uniform mat4 modelViewMatrix; \nuniform mat4 projectionMatrix; \n \nuniform float pointSize; \n \nattribute vec3 vertexPosition; \nattribute vec4 vertexColor; \n \nvarying vec4 color; \n \nvoid main() { \n  color = vertexColor; \n \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0); \n  gl_PointSize = pointSize; \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],48:[function(t,e,r){arguments[4][44][0].apply(r,arguments)},{dup:44}],49:[function(t,e,r){e.exports=function(t){var e="uniform mat4 modelViewMatrix; \nuniform mat4 projectionMatrix; \n \nattribute vec3 vertexPosition; \nattribute vec4 vertexColor; \n \nvarying vec4 color; \n \nvoid main() { \n  color = vertexColor; \n \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0); \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],50:[function(t,e,r){e.exports=function(t){var e="precision mediump float; \n \nuniform sampler2D sampler; \n \nvarying vec2 textureCoordinate; \n \nvoid main() { \n  gl_FragColor = texture2D(sampler, textureCoordinate); \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],51:[function(t,e,r){arguments[4][41][0].apply(r,arguments)},{dup:41}],52:[function(t,e,r){e.exports=function(t){var e="precision mediump float; \n \nuniform sampler2D sampler; \nuniform float threshold; \n \nvarying vec2 textureCoordinate; \n \nvoid main() { \n  vec4 color = texture2D(sampler, textureCoordinate); \n  float luminance = dot(color.rgb, vec3(0.3, 0.59, 0.11)); \n  luminance = max(0.0, luminance - threshold); \n  color.rgb *= sign(luminance); \n \n  gl_FragColor = color; \n} \n \n";t=t||{};for(var r in t){var n=new RegExp("{{"+r+"}}","g");e=e.replace(n,t[r])}return e}},{}],53:[function(t,e,r){arguments[4][41][0].apply(r,arguments)},{dup:41}]},{},[1]);